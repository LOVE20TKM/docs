# 0. 什么是 LOVE20 协议

LOVE20 协议是一个基于 LP 治理权和社群共同见证的去中心化社群铸币协议。

# 1. 部署

- 资格
  - 首个代币：合约部署时自动创建
  - 非首个代币：父币有提案权的治理者
- 名称
  - 大写英文字母、数字
  - 开头不可以是数字
  - 必须是 6 个字符
- 父币
  - 除首个代币合约外，其余所有代币合约的父币，必须是协议所创建的代币
- 分配
  - 铸造 10%用于公平发射（合约创建时就铸造）
  - 预留 90%用于治理激励（激励领取时才被铸造，且只有治理合约有权力发起铸造且累计铸造不可超过预留的数量）

# 2. 公平发射（代币总量 10%）

- 申购铸造（10%）
  - 价格：按募集父币的目标量计算价格
  - 数量：不限
  - 结束：每一次申购都触发判定，若同时满足下面两个条件，则此申购后结束公平发射
    - 数量判定：累计申购额大于等于募资数量要求
    - 时间判定：从达成 50%最低募资数量开始计算持续时间，达到持续时间要求
  - 领取：申购结束后按申购额占比计算份额，扣除消耗的父币，领取剩余父币与申购到的代币
  - 底池：所有募资到的父币由合约永久保管
- 底池返还：
  - 可返还父币数量：申购时所消耗的父币数量
  - 需销毁代币数量：申购时的额度占比 \* 代币当前发行量
    - 当前代币发行量
      - 包含：公平发射的所有代币（含未领取得）、治理奖励已领取的代币
      - 不含：底池返还已退回的代币，无偿捐献给国库的代币

# 3. 治理（代币总量 45%）

公平发射完成后，首轮治理起始时间点即确定。计算方法为协议的部署所在区块加整数倍的单个环节（大约 7 天）对应的区块数，接下来最近的区块高度，作为启动时间点。

### 3.1 资格

- 加入：与父币组 LP 后，选择承诺释放期并质押，计算治理票数：LP 数量乘以释放期倍数，最小 1 代表 4 周后释放，最大 3 代表 12 周后释放，后续追加 LP 质押，则承诺释放期只增不减
- 加成：质押代币，可获得提升激励倍数，最高不超过 3 倍
- 退出：当轮未行使投票权，可申请质押资产（LP 和代币）撤出，在承诺释放期后，可领取之前质押的资产

### 3.2 权力

- 环节：提案与投票（第 1~7 天）
  - 提案新增与修改（第 1~3 天）
    - 提案条件：
      - 持有不少于 0.5%的治理票
      - 每轮只可以做一次提案动作（新增提案或更新提案）
    - 新增提案：
      - 内容类
        - 标题
        - 内容
        - 轮数：质押后可持续挖矿多少轮
      - 资格类
        - 质押上限：
        - 地址限定：填写合约白名单地址
          - 不填写：任何地址都可以参与
          - 填写：合约需包含 isValidAddress 函数，提供：地址、轮次、提案 id，返回地址是否可参与挖矿
      - 验证类
        - 验证地址数量：每轮随机抽取多少地址验证并奖励
        - 挖矿内容要求：例如：发推文，并包含“$代币名称”
        - 验证票数建议：例如：满 5 天给 10 分，每少一天减 3 分，没有则 0 分
        - 备注信息要求：例如：社区可公开访问验证的社交平台个人主页地址
    - 更新提案：
      - 权限限定：提案发起人
      - 更改部分：挖矿内容、验证标准
      - 生效轮次：此轮开始生效，且投票人查看到的是最新的提案版本
  - 治理者投票：本轮矿池（第 4~7 天）
    - 多选投票：从候选矿池提案中，选择 1 个或多个提案投票
- 环节：社群共同验证（第 15~21 天）
  - 获取待验证地址：若无矿工参与，则无地址产生
  - 提交验证结果：传入一个数字和一个数组，前者代表弃权权重，后者按验证标准，为每个随机验证地址分配验证权重，弃权票按比例将奖励返还给国库，其余按权重分配验证票数，总票数等同于对此提案的投票数。

### 3.3 治理激励

- 总激励：本轮总激励的 50%
- 个体：根据权重分配，权重 = G + N，且不超过 3G，其中
  - G：行使验证权的治理票数
  - N：（质押代币数量 / 所有行使验证的地址质押代币数量）/ （行使验证权的治理票数 / 所有行使的票数）\* 行使验证权的治理票数，此值最大不超过 2 倍自己行使的治理票数
- 时间：本轮验证结束

# 4. 挖矿（代币总量 45%）

## 4.1 资格

- 加入：
  - 质押代币：根据提案要求质押
  - 备注信息：根据提案要求填写
  - 时间窗口：当前轮次挖矿进行到 90% 前
- 退出：提案规定轮次结束后，则自动退出挖矿，代币可随时领取

## 4.2 权力

- 环节：挖矿（第 8~14 天）
  - 根据当轮最新的提案要求，完成挖矿任务

## 4.3 激励

- 总激励：本轮激励的 50%
  - 提案激励：验证票数不少于本轮总治理票的 5%的提案有参与提案激励的资格，具体为：本轮总挖矿奖励 \* 当前提案获得验证票数 / 满足资格的提案的总验证票数
  - 弃权结余：追溯前面轮次此提案的弃权票对应激励
- 个体
  - 资格：被选中随机验证的地址
  - 数量：所获得的验证者投票数占总验证票数的比例 \* 总激励
- 时间：在验证结束后，可领取本轮挖矿奖励

# 5. 特殊情况

## 5.1 每轮首个验证的治理者

### 5.1.1 激励准备

- 周期池：奖励预留，即从国库中，分配 50%到当前周期池，用于本周期的 52 轮的激励
- 轮激励：当前 52 周期池的 1/52，其中 50%为治理激励，50%为挖矿激励

### 5.1.2 回收无人验证轮次激励

若上轮次未被标记为已回收，则检查上轮次是否无人验证，对于无人验证的轮次，将当轮奖励转回国库，并标记为已回收，并继续检查上一轮次，直至有人验证轮次停止

## 5.2 每个提案的首轮验证的治理者

### 5.2.1 验证地址准备

根据当前验证轮次的随机数种子，生成本轮需验证的地址

- 随机数种子：首个代币的最后一个超过 0.05%治理权的验证者地址+当轮结束时的区块高度

### 5.2.2 回收弃权票对应激励

检查每个提案的弃权票数对应激励并滚动到此提案的当前轮次激励，并标记此提案已回收
